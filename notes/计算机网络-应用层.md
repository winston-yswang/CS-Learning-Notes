## 应用层基础

应用层对应用程序的通信提供服务。

应用层协议定义：

- 应用进程交换的报文类型，请求还是响应？
- 各种报文类型的语法，如报文中的各个字段及其详细描述
- 字段的语义，即包含在字段中的信息的含义
- 进程何时、如何发送报文，以及对报文进行响应的规则

### 网络应用模型

- 客户/服务器模型（Client / Server）

- P2P模型（Peer-to-Peer）

### DNS系统

域名：$www.wys.com.$

<img src="pics\image-20211124144032740.png" alt="image-20211124144032740" style="zoom:50%;" />

域名服务器：

![image-20211124144614993](.\pics\image-20211124144614993.png)



### 电子邮件

> 组成结构

![image-20211124153516415](pics\image-20211124153516415.png)

> 简单邮件传送协议SMTP

SMTP规定了在两个相互通信的SMTP进程之间应该如何交换信息

负责发送邮件的SMTP进程是SMTP客户，负责接收邮件的进程是SMTP服务器

SMTP是使用TCP连接，端口号25，C/S模型

SMTP通信三个阶段：连接建立->邮件传送->连接释放

![image-20211124154042490](pics\image-20211124154042490.png)

SMTP的缺点：

1. SMTP不能传送可执行文件或者其他二进制对象
2. SMTP仅限于传送7位ASCII码
3. SMTP服务器会拒绝超过一定长度的邮件

解决方法：通用因特网邮件扩充MIME

> 邮件协议POP3

POP3使用TCP连接，端口号110，采用C/S模型。用于读取邮件

> 网际报文存取协议IMAP

当用户PC上的IMAP客户程序打开IMAP服务的邮箱时，用户可用看到邮箱的首部，若用户需要打开某个邮件，该邮件才上传到用户的计算机上。

> 基于万维网的电子邮件

用户代理与邮件服务器之间采用HTTP协议，邮件服务器之间才使用SMTP协议



### 文件传输协议

文件传送协议FTP（File Transfer Protocol）是基于C/S的协议，使用TCP实现可靠传输

简单文件传送协议TFTP（Trivial File Transfer Protocol）

![image-20211124144948658](pics\image-20211124144948658.png)



### 超文本传输协议

> 一次连接的过程：

1. 浏览器分析URL
2. 浏览器向DNS请求解析IP地址
3. DNS解析出IP地址
4. 浏览器与服务器建立TCP连接
5. 浏览器发出资源请求
6. 服务器响应
7. 释放TCP连接
8. 浏览器显示

> HTTP协议的特点

HTTP协议是无状态的。

Cookie是存储在用户主机中的文本文件，记录一段时间内某用户的访问记录。

HTTP采用TCP作为传输层协议，但HTTP协议本身是无连接的（通信双方在交换HTTP报文之前不需要先建立HTTP连接）

HTTP的连接方式

1. 持久连接（Keep alive）：流水线和非流水线
2. 非持久连接（Close）

<img src="pics\image-20211124152334250.png" alt="image-20211124152334250" style="zoom:50%;" />

> 报文结构

HTTP报文：报文是面向文本的，因此在报文中每一个字段都是一些ASCII码串

![image-20211124153007303](pics\image-20211124153007303.png)